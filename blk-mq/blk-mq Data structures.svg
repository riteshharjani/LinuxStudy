<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1110px" height="3242px" viewBox="-0.5 -0.5 1110 3242" content="&lt;mxfile modified=&quot;2019-02-14T07:00:33.920Z&quot; host=&quot;www.draw.io&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&quot; etag=&quot;LVmC_UJRvF20aGi6Peyg&quot; version=&quot;10.2.2&quot; type=&quot;github&quot;&gt;&lt;diagram name=&quot;Page-1&quot; id=&quot;9f46799a-70d6-7492-0946-bef42562c5a5&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" resource="https://www.draw.io/#Hriteshharjani%2FLinuxStudy%2Fmaster%2Fblk-mq%2Fblk-mq%20Data%20structures.svg" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="17" y="2" width="512" height="329" fill="#f8cecc" stroke="#b85450" stroke-width="5" pointer-events="none"/><g transform="translate(25.5,11.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="479" height="319" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 319px; max-width: 494px; width: 480px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><div><span><b><font style="font-size: 24px">struct blk_mq_ctx {</font></b></span></div><div> 10         <b>struct</b> {</div><div><font color="#cc0000"><b> 11                 spinlock_t                                                        lock;</b></font></div><div><span><b> 12                 struct list_head                                               rq_list;</b></span></div><div><span> 13         }  ____cacheline_aligned_in_smp;</span></div><div><span> 14</span></div><div><span> 15         unsigned int                                                              cpu;</span></div><div><span> 16         unsigned int                                                              index_hw;</span></div><div><span> 17</span></div><div><span> 18         /* incremented at dispatch time */</span></div><div><span> 19         unsigned long                                                           rq_dispatched[2];</span></div><div><span> 20         unsigned long                                                           rq_merged;</span></div><div><span> 21</span></div><div><span> 22         /* incremented at completion time */</span></div><div><span> 23         unsigned long  ____cacheline_aligned_in_smp      rq_completed[2];</span></div><div><span> 24</span></div><div><b> 25         struct request_queue                                            *queue;</b></div><div><b> 26         struct kobject                                                         kobj;</b></div><div><span> 27 } ____cacheline_aligned_in_smp;</span></div></div><div><br /></div></div></div></div></foreignObject><text x="240" y="167" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="569" y="8" width="520" height="940" fill="#f8cecc" stroke="#b85450" stroke-width="5" pointer-events="none"/><g transform="translate(577.5,17.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="494" height="922" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 930px; max-width: 502px; width: 495px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><div><div><div><span><font style="font-size: 24px"><b>struct blk_mq_hw_ctx {</b></font></span></div><div><span> 13         struct {</span></div><div><span><b><font color="#cc0000"> 14                 spinlock_t                           lock;</font></b></span></div><div><span><b> 15                 struct list_head                  dispatch;</b></span></div><div><span> 16                 unsigned long                      state;          /* BLK_MQ_S_* flags */</span></div><div><span> 17         } ____cacheline_aligned_in_smp;</span></div><div><span> 18</span></div><div><b> 19         struct delayed_work                 run_work;</b></div><div><span> 20         cpumask_var_t                           cpumask;</span></div><div><span> 21         int                                                next_cpu;</span></div><div><span> 22         int                                                next_cpu_batch;</span></div><div><span> 23</span></div><div> 24         unsigned long                              <b>flags</b>;          /* <b>BLK_MQ_F_</b>* flags */</div><div><span> 25</span></div><div><b> 26         void                                          *sched_data;</b></div><div><b> 27         struct request_queue             *queue;</b></div><div><b> 28         struct blk_flush_queue          *fq;</b></div><div><span> 29</span></div><div><span> 30         void                                           *driver_data;</span></div><div><span> 31</span></div><div><b> 32         struct sbitmap                          ctx_map;</b></div><div><span> 33</span></div><div><b> 34         struct blk_mq_ctx                    **ctxs;</b></div><div><span> 35         unsigned int                               nr_ctx;</span></div><div><span> 36  </span></div><div><span><font color="#cc00cc"><b> 37         wait_queue_entry_t                 dispatch_wait;</b></font></span></div><div><span><font color="#cc00cc"><b> 38         atomic_t                                    wait_index;</b></font></span></div><div><span> 39</span></div><div><b> 40         struct blk_mq_tags                  *tags;</b></div><div><b> 41         struct blk_mq_tags                  *sched_tags;</b></div><div><span> 42</span></div><div><span> 43         unsigned long                             queued;</span></div><div><span> 44         unsigned long                             run;</span></div><div><span> 45 #define BLK_MQ_MAX_DISPATCH_ORDER       7</span></div><div><span> 46         unsigned long           dispatched[BLK_MQ_MAX_DISPATCH_ORDER];</span></div><div><span> 47</span></div><div><span> 48         unsigned int                                numa_node;</span></div><div><span> 49         unsigned int                                queue_num;</span></div><div><span> 50</span></div><div><span> 51         atomic_t                                      nr_active;</span></div><div><span> 52</span></div><div><b> 53         struct hlist_node                       cpuhp_dead;</b></div><div><b> 54         struct kobject                             kobj;</b></div><div><span> 55</span></div><div><span> 56         unsigned long                              poll_considered;</span></div><div><span> 57         unsigned long                              poll_invoked;</span></div><div><span> 58         unsigned long                              poll_success;</span></div><div><span> 59</span></div><div><span> 60 #ifdef CONFIG_BLK_DEBUG_FS</span></div><div><b> 61         struct dentry                              *debugfs_dir;</b></div><div><b> 62         struct dentry                              *sched_debugfs_dir;</b></div><div><span> 63 #endif</span></div><div><span> 64</span></div><div><span> 65         /* Must be the last member - see also blk_mq_hw_ctx_size(). */</span></div><div><b> 66         struct srcu_struct                      queue_rq_srcu[0];</b></div><div><span> 67 };</span></div></div></div></div><div><br /></div></div></div></div></foreignObject><text x="247" y="468" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="20" y="628" width="449" height="310" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(26.5,635.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="431" height="304" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 304px; max-width: 435px; width: 432px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><font style="font-size: 18px">/* filled and provided by LLD */</font></div><div><font style="font-size: 24px"><b>struct blk_mq_tag_set {</b></font></div><div><font style="font-size: 14px">(below mq_map[cpu] will give the hctx index)</font></div><div style="font-size: 14px"> 70         unsigned int                             *mq_map;</div><div style="font-size: 14px"><b> 71         const struct blk_mq_ops      *ops;</b></div><div style="font-size: 14px"><b><br /></b></div><div style="font-size: 14px"> 72         unsigned int            nr_hw_queues;</div><div style="font-size: 14px"> 73         unsigned int            queue_depth;    /* max hw supported */</div><div style="font-size: 14px"> 74         unsigned int            reserved_tags;</div><div style="font-size: 14px"> 75         unsigned int            cmd_size;       /* per-request extra data */</div><div style="font-size: 14px"> 76         int                            numa_node;</div><div style="font-size: 14px"> 77         unsigned int            timeout;</div><div style="font-size: 14px"> 78         unsigned int            flags;          /* BLK_MQ_F_* */</div><div style="font-size: 14px"><b> 79         void                        *driver_data;</b></div><div style="font-size: 14px"> 80</div><div style="font-size: 14px"><b> 81         struct blk_mq_tags      **tags;</b></div><div style="font-size: 14px"><span style="color: rgb(204 , 0 , 0)"> 83         </span><b style="color: rgb(204 , 0 , 0)">struct mutex</b><span style="color: rgb(204 , 0 , 0)">                  </span><b style="color: rgb(204 , 0 , 0)">tag_list_lock</b><span style="color: rgb(204 , 0 , 0)">;</span><br /></div><div style="font-size: 14px"><b> 84         struct list_head             tag_list;</b></div><div style="font-size: 14px"> 85 };</div><div style="font-size: 14px"><br /></div></div></div></foreignObject><text x="216" y="159" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="616" y="972" width="460" height="438" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(622.5,979.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="429" height="430" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 432px; max-width: 446px; width: 430px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div>160 enum {</div><div>161         BLK_MQ_F_SHOULD_MERGE   = 1 &lt;&lt; 0,</div><div>162         BLK_MQ_F_TAG_SHARED     = 1 &lt;&lt; 1,</div><div>163         BLK_MQ_F_SG_MERGE       = 1 &lt;&lt; 2,</div><div>164         BLK_MQ_F_BLOCKING       = 1 &lt;&lt; 5,</div><div>165         BLK_MQ_F_NO_SCHED       = 1 &lt;&lt; 6,</div><div>166         BLK_MQ_F_ALLOC_POLICY_START_BIT = 8,</div><div>167         BLK_MQ_F_ALLOC_POLICY_BITS = 1,</div><div>168</div><div>169         BLK_MQ_S_STOPPED        = 0,</div><div>170         BLK_MQ_S_TAG_ACTIVE     = 1,</div><div>171         BLK_MQ_S_SCHED_RESTART  = 2,</div><div>172         BLK_MQ_S_TAG_WAITING    = 3,</div><div>173         BLK_MQ_S_START_ON_RUN   = 4,</div><div>174</div><div>175         BLK_MQ_MAX_DEPTH        = 10240,</div><div>176</div><div>177         BLK_MQ_CPU_WORK_BATCH   = 8,</div><div>178 };</div><div><br /></div><div>179 #define BLK_MQ_FLAG_TO_ALLOC_POLICY(flags) \</div><div>180         ((flags &gt;&gt; BLK_MQ_F_ALLOC_POLICY_START_BIT) &amp; \</div><div>181                 ((1 &lt;&lt; BLK_MQ_F_ALLOC_POLICY_BITS) - 1))</div><div>182 #define BLK_ALLOC_POLICY_TO_MQ_FLAG(policy) \</div><div>183         ((policy &amp; ((1 &lt;&lt; BLK_MQ_F_ALLOC_POLICY_BITS) - 1)) \</div><div>184                 &lt;&lt; BLK_MQ_F_ALLOC_POLICY_START_BIT)</div><div><br /></div></div></div></div></div></div></div></div></div></div></div></div></div></div></foreignObject><text x="215" y="222" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="616" y="1669" width="460" height="780" fill="#e1d5e7" stroke="#9673a6" pointer-events="none"/><g transform="translate(622.5,1676.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="344" height="774" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 774px; max-width: 446px; width: 345px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><font style="font-size: 24px"><b>struct request_queue {</b></font></div><div>        dma_drain_needed_fn     *dma_drain_needed;</div><div>        lld_busy_fn                       *lld_busy_fn;</div><div><br /></div><div><b>+       struct blk_mq_ops        *mq_ops;</b></div><div>+</div><div>+       unsigned int                     *mq_map;</div><div>+</div><div>+       /* sw queues */</div><div><b>+       struct blk_mq_ctx         *queue_ctx;</b></div><div>+       unsigned int                     nr_queues;</div><div>+</div><div>+       /* hw dispatch queues */</div><div><b>+       struct blk_mq_hw_ctx   **queue_hw_ctx;</b></div><div>+       unsigned int                      nr_hw_queues;</div><div>+</div><div><br /></div><div><div>        struct kobject                      kobj;</div><div><br /></div><div>+       /*</div><div>+        * mq queue kobject</div><div>+        */</div><div><b>+       struct kobject                   mq_kobj;</b></div></div><div><br /></div><div><div><b> 534         struct list_head            requeue_list;</b></div><div><font color="#cc0000"><b> 535         spinlock_t                    requeue_lock;</b></font></div><div><b><font color="#cc00cc"> 536         struct delayed_work    requeue_work;</font></b></div><div> 537</div><div><br /></div><div> 540         atomic_t                        mq_freeze_depth;</div></div><div><br /></div><div><span>-       struct request                     flush_rq;</span><br /></div><div><div><b>+       union {</b></div><div><b>+               struct request          flush_rq;</b></div><div><b>+               struct {</b></div><div><font color="#cc0000"><b>+                       spinlock_t        mq_flush_lock;</b></font></div><div><font color="#cc00cc"><b>+         struct work_struct         mq_flush_work;</b></font></div><div>+               };</div><div>+       };</div></div><div><br /></div><div><div><b><font color="#cc00cc">+       wait_queue_head_t            mq_freeze_wq;</font></b></div><div><b>+       struct percpu_counter       mq_usage_counter;</b></div><div>+       struct list_head                     all_q_node;</div></div><div><br /></div><div><div><b> 555         struct blk_mq_tag_set   *tag_set;</b></div><div><b> 556         struct list_head        tag_set_list;</b></div><div> 557         struct bio_set          bio_split;</div></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div></div></div></foreignObject><text x="172" y="394" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="19" y="1249" width="343" height="285" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(25.5,1256.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="312" height="279" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 279px; max-width: 329px; width: 313px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><div><div><div><div><div><div><div><div><div><div><div style="font-size: 14px">  7 /*</div><div style="font-size: 14px">  8  * Tag address space map.</div><div style="font-size: 14px">  9  */</div><div><font style="font-size: 24px"><b>struct blk_mq_tags {</b></font></div><div style="font-size: 14px"> 11         unsigned int              nr_tags;</div><div style="font-size: 14px"> 12         unsigned int              nr_reserved_tags;</div><div style="font-size: 14px"> 13</div><div style="font-size: 14px"><b><font color="#cc00cc"> 14         atomic_t                   active_queues;</font></b></div><div style="font-size: 14px"> 15</div><div style="font-size: 14px"><b> 16         struct sbitmap_queue bitmap_tags;</b></div><div style="font-size: 14px"><b> 17         struct sbitmap_queue breserved_tags;</b></div><div style="font-size: 14px"> 18</div><div style="font-size: 14px"><b> 19         struct request          **rqs;</b></div><div style="font-size: 14px"><b> 20         struct request          **static_rqs;</b></div><div style="font-size: 14px"><b> 21         struct list_head       page_list;</b></div><div style="font-size: 14px"> 22 };</div><div style="font-size: 14px"><br /></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></foreignObject><text x="156" y="147" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="17" y="1129" width="537" height="100" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(23.5,1136.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="521" height="94" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 94px; max-width: 523px; width: 522px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div>200 enum {</div><div>201         BLK_MQ_REQ_NOWAIT       = (1 &lt;&lt; 0), /* return when out of requests */</div><div>202         BLK_MQ_REQ_RESERVED     = (1 &lt;&lt; 1), /* allocate from reserved pool */</div><div>203         BLK_MQ_REQ_INTERNAL     = (1 &lt;&lt; 2), /* allocate internal/sched tag */</div><div>204 };</div><div><br /></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></foreignObject><text x="261" y="54" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="17" y="968" width="382" height="130" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(23.5,975.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="336" height="124" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 124px; max-width: 368px; width: 337px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 14px"><div style="font-size: 24px"><div><div><b>struct blk_mq_queue_data {</b></div><div><b> 88         struct request     *rq;</b></div><div> 89         bool                       last;</div><div> 90 };</div><div><br /></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></foreignObject><text x="168" y="69" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1076 2059 L 1076 2059" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1076 2059 L 1076 2059 L 1076 2059 L 1076 2059 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 12.83 2286.17 L 11.94 2287.06" fill="none" stroke="#000033" stroke-miterlimit="10" pointer-events="none"/><path d="M 12.81 2286.19 L 12.23 2287.94 L 11.94 2287.06 L 11.06 2286.77 Z" fill="#000033" stroke="#000033" stroke-miterlimit="10" pointer-events="none"/><rect x="17" y="418" width="372" height="180" fill="#f8cecc" stroke="#b85450" stroke-width="5" pointer-events="none"/><g transform="translate(25.5,427.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="304" height="170" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 170px; max-width: 354px; width: 305px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><div><div><b><font style="font-size: 24px">struct blk_mq_alloc_data {</font></b></div><div>110         /* input parameter */</div><div><b>111         struct request_queue *q;</b></div><div>112         unsigned int <b>flags</b>;</div><div>113         unsigned int shallow_depth;</div><div>114</div><div>115         /* input &amp; output parameter */</div><div><b>116         struct blk_mq_ctx *ctx;</b></div><div><b>117         struct blk_mq_hw_ctx *hctx;</b></div><div>118 };</div></div></div></div><div><br /></div></div></div></foreignObject><text x="152" y="92" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 1009 228 Q 1059 228 1034 203 Q 1009 178 1049 518 Q 1089 858 854.75 969.27" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 850.01 971.52 L 854.83 965.36 L 854.75 969.27 L 857.83 971.68 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 199 498 Q 249 498 224 473 Q 199 448 93.97 1126.71" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 93.17 1131.9 L 90.78 1124.44 L 93.97 1126.71 L 97.7 1125.51 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 289 578 Q 339 578 314 553 Q 289 528 559.86 486.25" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 565.79 485.34 L 558.49 490.51 L 559.86 486.25 L 557.27 482.61 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 269 558 Q 319 558 294 533 Q 269 508 269 341.24" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 269 335.24 L 273 343.24 L 269 341.24 L 265 343.24 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="22" y="1669" width="402" height="310" fill="#e1d5e7" stroke="#9673a6" pointer-events="none"/><g transform="translate(28.5,1676.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="387" height="304" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 304px; max-width: 388px; width: 388px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><font style="font-size: 24px"><b>struct request {</b></font></div><div><font size="3"><br /></font></div><div><font size="3">-       struct list_head                         queuelist;</font></div><div><font size="3">-       struct call_single_data              csd;</font></div><div><font size="3">+       union {</font></div><div><font size="3">+               struct list_head                queuelist;</font></div><div><font size="3">+               struct llist_node               ll_list;</font></div><div><font size="3">+       };</font></div><div><font size="3">+       union {</font></div><div><font size="3"><b>+               struct call_single_data     csd;</b></font></div><div><font size="3" color="#cc00cc"><b>+               struct work_struct            mq_flush_data;</b></font></div><div><font size="3">+       };</font></div><div><font size="3"><br /></font></div><div><font size="3"><b>        struct request_queue               *q;</b></font></div><div><font size="3"><b>+      struct blk_mq_ctx                    *mq_ctx;</b></font></div><div><font size="3"><br /></font></div><div><br /></div></div></div></foreignObject><text x="194" y="159" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 359 1949 Q 419 1939 394 1914 Q 369 1889 468.47 340.22" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 468.86 334.23 L 472.34 342.47 L 468.47 340.22 L 464.35 341.96 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 899 1839 Q 949 1839 949 1694 Q 949 1549 859 1569 Q 769 1589 333.07 338.78" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 331.09 333.11 L 337.51 339.35 L 333.07 338.78 L 329.95 341.98 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 939 1899 Q 989 1899 1029 1879 Q 1069 1859 811.24 946.93" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 809.61 941.15 L 815.63 947.76 L 811.24 946.93 L 807.93 949.94 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><rect x="0.5" y="2529" width="547" height="550" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(7.5,2536.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="533" height="498" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 544px; max-width: 533px; width: 533px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><span><font style="font-size: 24px"><b>struct blk_mq_ops {</b></font></span></div><div><span><font size="3">110         /*</font></span></div><div><span><font size="3">111          * Queue request</font></span></div><div><span><font size="3">112          */</font></span></div><div><span><font size="3"><b>113         queue_rq_fn             *queue_rq;</b></font></span></div><div><span><font size="3">114</font></span></div><div><span><font size="3">115         /*</font></span></div><div><span><font size="3">116          * Called on request timeout</font></span></div><div><span><font size="3">117          */</font></span></div><div><span><font size="3"><b>118         timeout_fn              *timeout;</b></font></span></div><div><span><font size="3">119</font></span></div><div><span><font size="3">120         /*</font></span></div><div><span><font size="3">121          * Called to poll for completion of a specific tag.</font></span></div><div><span><font size="3">122          */</font></span></div><div><span><font size="3"><b>123         poll_fn                 *poll;</b></font></span></div><div><span><font size="3">124</font></span></div><div><span><font size="3"><b>125         softirq_done_fn         *complete;</b></font></span></div><div><span><font size="3">126</font></span></div><div><span><font size="3">127         /*</font></span></div><div><span><font size="3">128          * Called when the block layer side of a hardware queue has been</font></span></div><div><span><font size="3">129          * set up, allowing the driver to allocate/init matching structures.</font></span></div><div><span><font size="3">130          * Ditto for exit/teardown.</font></span></div><div><span><font size="3">131          */</font></span></div><div><span><font size="3"><b>132         init_hctx_fn            *init_hctx;</b></font></span></div><div><span><font size="3"><b>133         exit_hctx_fn            *exit_hctx;</b></font></span></div><div><br /></div></div></div></div></foreignObject><text x="267" y="256" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="569" y="2689" width="540" height="550" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(575.5,2696.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="525" height="470" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 544px; max-width: 526px; width: 526px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><span style="font-size: medium">135         /*</span><br /></div><div><span><font size="3">136          * Called for every command allocated by the block layer to allow</font></span></div><div><span><font size="3">137          * the driver to set up driver specific data.</font></span></div><div><span><font size="3">138          *</font></span></div><div><span><font size="3">139          * Tag greater than or equal to queue_depth is for setting up</font></span></div><div><span><font size="3">140          * flush request.</font></span></div><div><span><font size="3">141          *</font></span></div><div><span><font size="3">142          * Ditto for exit/teardown.</font></span></div><div><span><font size="3">143          */</font></span></div><div><span><font size="3"><b>144         init_request_fn         *init_request;</b></font></span></div><div><span><font size="3"><b>145         exit_request_fn         *exit_request;</b></font></span></div><div><span><font size="3">146         /* Called from inside blk_get_request() */</font></span></div><div><span><font size="3"><b>147         void (*initialize_rq_fn)(struct request *rq);</b></font></span></div><div><span><font size="3">148</font></span></div><div><span><font size="3"><b>149         map_queues_fn           *map_queues;</b></font></span></div><div><span><font size="3">150</font></span></div><div><span><font size="3">151 #ifdef CONFIG_BLK_DEBUG_FS</font></span></div><div><span><font size="3">152         /*</font></span></div><div><span><font size="3">153          * Used by the debugfs implementation to show driver-specific</font></span></div><div><span><font size="3">154          * information about a request.</font></span></div><div><span><font size="3">155          */</font></span></div><div><span><font size="3"><b>156         void (*show_rq)(struct seq_file *m, struct request *rq);</b></font></span></div><div><span><font size="3">157 #endif</font></span></div><div><span><font size="3">158 };</font></span></div></div><div><br /></div></div></div></foreignObject><text x="263" y="242" fill="#000000" text-anchor="middle" font-size="14px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="17" y="1994" width="562" height="485" fill="#f8cecc" stroke="#b85450" pointer-events="none"/><g transform="translate(23.5,2001.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="548" height="479" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Verdana; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 479px; max-width: 548px; width: 548px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><div><span><font style="font-size: 14px">  /*</font></span></div><div><span><font size="3">  * Driver command data is immediately after the request. <br />  * So subtract request</font></span></div><div><span><font size="3">  * size to get back to the original request, add request size to get    * the PDU.</font></span></div><div><span><font size="3">  */</font></span></div><div><span><font size="3"><br /></font></span></div><div><span><font size="3">275 static inline struct request *blk_mq_rq_from_pdu(void *pdu)</font></span></div><div><span><font size="3">276 {</font></span></div><div><span><font size="3">277         return pdu - sizeof(struct request);</font></span></div><div><span><font size="3">278 }</font></span></div><div><span><font size="3">279 static inline void *blk_mq_rq_to_pdu(struct request *rq)</font></span></div><div><span><font size="3">280 {</font></span></div><div><span><font size="3">281         return rq + 1;</font></span></div><div><span><font size="3">282 }</font></span></div><div><span><font size="3">283</font></span></div><div><span><font size="3">284 #define queue_for_each_hw_ctx(q, hctx, i)                         \</font></span></div><div><span><font size="3">285         for ((i) = 0; (i) &lt; (q)-&gt;nr_hw_queues &amp;&amp;                    \</font></span></div><div><span><font size="3">286              ({ hctx = (q)-&gt;queue_hw_ctx[i]; 1; }); (i)++)</font></span></div><div><span><font size="3">287</font></span></div><div><span><font size="3">288 #define hctx_for_each_ctx(hctx, ctx, i)                               \</font></span></div><div><span><font size="3">289         for ((i) = 0; (i) &lt; (hctx)-&gt;nr_ctx &amp;&amp;                            \</font></span></div><div><span><font size="3">290              ({ ctx = (hctx)-&gt;ctxs[(i)]; 1; }); (i)++)</font></span></div><div><span><font size="3">291</font></span></div><div><span><font size="3">292 #endif</font></span></div></div></div><div><br /></div></div></div></foreignObject><text x="274" y="247" fill="#000000" text-anchor="middle" font-size="14px" font-family="Verdana">[Not supported by viewer]</text></switch></g><rect x="584" y="2509" width="492" height="160" fill="#e1d5e7" stroke="#9673a6" pointer-events="none"/><g transform="translate(590.5,2516.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="478" height="154" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 14px; font-family: Verdana; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; overflow: hidden; max-height: 154px; max-width: 478px; width: 478px; white-space: normal; overflow-wrap: normal;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><div><div><b><font style="font-size: 24px"> struct blk_plug {</font></b></div><div><span><br /></span></div><div><span>     unsigned long magic; /* detect uninitialized use-cases */</span><br /></div><div><span style="font-size: medium">     struct list_head list; /* requests */</span><br /></div><div><b><font size="3">+   struct list_head mq_list; /* blk-mq requests */</font></b></div><div><font size="3">     struct list_head cb_list; /* md requires an unplug callback */</font></div><div><font size="3"> };</font></div></div><div><br /></div></div></div></foreignObject><text x="239" y="84" fill="#000000" text-anchor="middle" font-size="14px" font-family="Verdana">[Not supported by viewer]</text></switch></g><path d="M 299 1479 Q 349 1479 324 1454 Q 299 1429 213.84 1661.27" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 211.77 1666.9 L 210.77 1658.01 L 213.84 1661.27 L 218.28 1660.77 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 299 879 Q 349 879 324 854 Q 299 829 319 884 Q 339 939 379 954 Q 419 969 271.49 1241.76" fill="none" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/><path d="M 268.63 1247.03 L 268.92 1238.09 L 271.49 1241.76 L 275.96 1241.9 Z" fill="#000000" stroke="#000000" stroke-width="2" stroke-miterlimit="10" pointer-events="none"/></g></svg>